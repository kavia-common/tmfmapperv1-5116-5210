{"is_source_file": true, "format": "Python", "description": "This file defines metrics collection and exposure for a Flask web application, including counters and latency tracking, with routes to retrieve current metrics.", "external_files": ["flask", "time", "typing", "threading"], "external_methods": ["flask.Blueprint", "flask.jsonify", "flask.current_app", "flask.g", "time.time"], "published": ["inc_counter", "record_request_metrics", "get_metrics"], "classes": [], "methods": [{"name": "_record_latency(ms: int)", "description": "Updates the latency metrics with a new latency measurement in milliseconds.", "scope": "", "scopeKind": ""}, {"name": "inc_counter(name: str, amount: int = 1)", "description": "Safely increment a named counter metric.", "scope": "", "scopeKind": ""}, {"name": "record_request_metrics(start_ts: float)", "description": "Records metrics related to a request, including latency, given its start timestamp.", "scope": "", "scopeKind": ""}, {"name": "get_metrics()", "description": "Returns current request counters and latency data as a JSON response.", "scope": "", "scopeKind": ""}], "calls": ["with _lock:", "_record_latency(dur_ms)", "time()", "jsonify(body)"], "search-terms": ["metrics", "Flask", "latency", "counters", "threading", "request metrics"], "state": 2, "file_id": 22, "knowledge_revision": 61, "git_revision": "", "ctags": [{"_type": "tag", "name": "_lock", "path": "/home/kavia/workspace/code-generation/tmfmapperv1-5116-5210/FlaskTMFTranslationMiddleware/app/observability/metrics.py", "pattern": "/^_lock = threading.RLock()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_metrics", "path": "/home/kavia/workspace/code-generation/tmfmapperv1-5116-5210/FlaskTMFTranslationMiddleware/app/observability/metrics.py", "pattern": "/^_metrics = {$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_record_latency", "path": "/home/kavia/workspace/code-generation/tmfmapperv1-5116-5210/FlaskTMFTranslationMiddleware/app/observability/metrics.py", "pattern": "/^def _record_latency(ms: int):$/", "language": "Python", "kind": "function", "signature": "(ms: int)"}, {"_type": "tag", "name": "blp", "path": "/home/kavia/workspace/code-generation/tmfmapperv1-5116-5210/FlaskTMFTranslationMiddleware/app/observability/metrics.py", "pattern": "/^blp = Blueprint(\"Metrics\", \"metrics\", url_prefix=\"\\/\", description=\"Metrics endpoint\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "get_metrics", "path": "/home/kavia/workspace/code-generation/tmfmapperv1-5116-5210/FlaskTMFTranslationMiddleware/app/observability/metrics.py", "pattern": "/^def get_metrics():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "inc_counter", "path": "/home/kavia/workspace/code-generation/tmfmapperv1-5116-5210/FlaskTMFTranslationMiddleware/app/observability/metrics.py", "pattern": "/^def inc_counter(name: str, amount: int = 1):$/", "language": "Python", "kind": "function", "signature": "(name: str, amount: int = 1)"}, {"_type": "tag", "name": "record_request_metrics", "path": "/home/kavia/workspace/code-generation/tmfmapperv1-5116-5210/FlaskTMFTranslationMiddleware/app/observability/metrics.py", "pattern": "/^def record_request_metrics(start_ts: float):$/", "language": "Python", "kind": "function", "signature": "(start_ts: float)"}], "hash": "ae7118af05ceb1ed2fd69dc95d22d35b", "format-version": 4, "code-base-name": "FlaskTMFTranslationMiddleware", "filename": "FlaskTMFTranslationMiddleware/app/observability/metrics.py", "fields": [{"name": "_lock = threading.RLock()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_metrics = {", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "blp = Blueprint(\"Metrics\", \"metrics\", url_prefix=\"\\/\", description=\"Metrics endpoint\")", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"61": ""}]}